# üçù Recipe Chatbot - OpenAi_project

A web application built with **Next.js**, developed in **TypeScript** and styled with **TailwindCSS**, integrating the **OpenAI API** to deliver a culinary-themed chatbot.

Upon entering the platform, the user is greeted by a **virtual waiter** who asks a few playful questions and then proposes **3 randomly selected chefs** from the available list. The user can pick their favorite through a modal window, continuing into a humorous and intentionally irritating conversation with the chatbot.

## üéØ Project Goal

The application is deliberately ironic and unhelpful.

Agents‚Äô prompts are designed to produce funny, unpredictable, and confusing responses.

All steps update the session (history and step) to maintain flow consistency.

This project is not meant to be a serious cooking assistant. Instead, it is a **creative experiment** in human‚ÄìAI interaction that aims to:

- Playfully engage users in a culinary context
- Explore unconventional UX with humor and irritation
- Showcase the integration of Next.js, TailwindCSS, and OpenAI API in a real-world application

---

## üöÄ Features

- **No authentication required** ‚Äì instant access to the platform
- **Virtual waiter persona** with humorous and sarcastic tone
- **Select Chefs (Modal)** ‚Äì multiple personalities with integrated agents
- **Dynamic conversation** powered by OpenAI
- **Responsive UI** styled with TailwindCSS

---

## üõ†Ô∏è Tech Stack

- [Next.js](https://nextjs.org/) ‚Äì Full-stack React framework
- [TypeScript](https://www.typescriptlang.org/) ‚Äì Static typing for JavaScript
- [TailwindCSS](https://tailwindcss.com/) ‚Äì Utility-first CSS framework
- [OpenAI API](https://platform.openai.com/) ‚Äì Conversational AI model

---

## üì¶ Setup Instructions

### 1. Clone the repository

```bash
git clone https://github.com/StefAltavista/OpenAi_project.git
cd OpenAi_project
```

### 2. Install dependencies

Make sure you have **Node.js (>=18)** installed, then run:

```bash
npm install
```

### 3. Configure environment variables

Create a `.env.local` file in the project root and add your OpenAI API key:

```
OPENAI_API_KEY=your_api_key_here
```

### 4. Start the development server

```bash
npm run dev
```

The app will be available at [http://localhost:3000](http://localhost:3000).

### 5. Build for production

```bash
npm run build
npm start
```

---

## üìÇ Project Structure

The repository is organized as follows:

```
OpenAi_project/
‚îú‚îÄ‚îÄ .next/                 # Build output (auto-generated by Next.js)
‚îú‚îÄ‚îÄ node_modules/          # Installed dependencies
‚îú‚îÄ‚îÄ public/                # Static assets (images, icons, etc.)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/               # Next.js routing and pages
‚îÇ   ‚îú‚îÄ‚îÄ components/        # Reusable UI components
‚îÇ   ‚îú‚îÄ‚îÄ data/              # Static data or mock data
‚îÇ   ‚îú‚îÄ‚îÄ hooks/             # Custom React hooks
‚îÇ   ‚îî‚îÄ‚îÄ lib/               # Utility functions and helpers
‚îú‚îÄ‚îÄ config/                # Project configurations (Next.js, Tailwind, ESLint, etc.)
‚îî‚îÄ‚îÄ README.md              # Project documentation
```

---

# Interaction with OpenAI

This documentation describes how the application interacts with OpenAI through three agents:

- **Waiter Agent** ‚Üí general conversational assistant, ironic and deliberately unhelpful.
- **Cook Agent** ‚Üí guides recipe preparation with confusing responses and deliberately wrong ingredients.
- **AI Assistant (JSON Creator)** ‚Üí technical agent that returns only structured JSON outputs, used to extract information from Cook's responses.

---

## üîÑ General Flow Diagram

[User] -> [Frontend React] -> Waiter Agent / Cook Agent -> AI Assistant -> Updated session

---

## üçΩÔ∏è Waiter Agent ‚Äì `POST /api/waiter`

### Overview

Manages general user conversation in a **ironic and deliberately unhelpful** tone, updating the session state step-by-step via `switchWaiterState`.

### Main Steps and Prompts

| Step             | Prompt / Instructions                                                                                  | Expected Behavior                            |
| ---------------- | ------------------------------------------------------------------------------------------------------ | -------------------------------------------- |
| WELCOME          | "You are a digital Waiter in an app that provides recipes upon request. Greet and welcome the user..." | Short greeting (<20 words), ironic tone      |
| ASK_RECIPE       | "Answer politely to whatever the user says. Ask what recipe they want."                                | Invite user to choose a recipe, playful tone |
| PROPOSE_COOK     | "Extrapolate the name of the recipe from this message..."                                              | Identify recipe, propose random cooks        |
| COOK_SELECTED    | "Give a weird feedback about the user's choice..."                                                     | Ironic/absurd comment, handoff to Cook       |
| RETURN_TO_WAITER | "Apologize to the user and offer new cooks..."                                                         | Ironic tone, new selection of cooks          |

### Example Conversation

**User:** "I want advice for dinner."  
**Waiter:** "Dinner? Wasn't it breakfast time? I'd eat cookies and see how it goes."

---

## üë®‚Äçüç≥ Cook Agent ‚Äì `POST /api/cook`

### Overview

Guides the user through the recipe in a deliberately **confusing and ironic** way, also producing ingredient lists that are often wrong.  
For creation of this agent we followed the guidelines of OpenAi documentation: Agents SDK TypeScript -> https://openai.github.io/openai-agents-js/

### Main Steps and Prompts

| Step             | Prompt / Instructions                                                      | Expected Behavior                         |
| ---------------- | -------------------------------------------------------------------------- | ----------------------------------------- |
| SALUTE           | "Say Hello, make a silly comment about the recipe, ask if user has a diet" | Ironic greeting and joke about the recipe |
| ASK_ALLERGY      | "Extrapolate diet info from the user message"                              | Store any diet information                |
| RANDOM_QUESTION  | "Extrapolate allergies and ask a random question"                          | Absurd question, playful tone             |
| LIST_INGREDIENTS | "Now give a wrong recipe with random scales, maybe wrong allergens"        | Deliberately wrong ingredients, confusing |
| END              | "Say goodbye and handoff to the waiter"                                    | Ends session with ironic tone             |
| RETURN_TO_WAITER | "The cook session has ended. Returning to the waiter..."                   | Session ended, handoff to Waiter          |

### Code extract

/lib/switchCookState.ts

```typescript
import { run } from "@openai/agents"; // call function run from openai libraries
import { ai_assistant } from "./ai_assistant";

type CookState =
  | "SALUTE"
  | "ASK_ALLERGY"
  | "ASK_DIET"
  | "RANDOM_QUESTION"
  | "LIST_INGREDIENTS"
  | "END"
  | "RETURN_TO_WAITER";

export interface CookSession {
  id: string;
  cookID: string;
  recipe: string;
  step: CookState;
  history: { role: string; content: string }[];
  allergies?: string[];
  diet?: string[];
  ingredients?: string[];
}

// Function to switch the state of the cook session based on the current step

export default async function switchCookState(
  session: CookSession
): Promise<CookSession> {
  const bot = ai_assistant();
  let response;

switch (session.step) {
    // Initial greeting and asking about diet
    case "SALUTE":
      session.history.push({
        role: "cook",
        content: `Say Hello to our guest, make a silly comment about the recipe and ask if the user is on a specific diet`,
      });
      session.step = "ASK_ALLERGY";
      return session;

...

```

### Example Conversation

**User:** "How do I make carbonara?"  
**Cook:** "First throw chocolate into the spaghetti‚Ä¶ oh and add a pinch of sugared pepper!"

---

## ü§ñ AI Assistant ‚Äì `lib/ai_assistant.ts`

### Overview

Technical agent that returns **only JSON**.  
Mainly used by the Cook Agent to extract structured data (ingredients, messages).

### Example Output

Input:

```txt
Extrapolate ingredients in JSON from: "Great! For a carbonara you need spaghetti, guanciale, eggs, and pecorino."
```

Output:

```json
{
  "message": "Great! For a carbonara you need...",
  "ingredients": ["spaghetti", "guanciale", "eggs", "pecorino"]
}
```

---

## ‚òÅÔ∏è Deployment on Vercel

This project can be easily deployed to [Vercel](https://vercel.com/), the official platform for Next.js apps.

### 1. Push to GitHub

Ensure your repository is available on GitHub.

### 2. Import the project into Vercel

- Go to [Vercel Dashboard](https://vercel.com/dashboard)
- Click **New Project** ‚Üí **Import Git Repository**
- Select your GitHub repository

### 3. Configure environment variables

In the Vercel dashboard, go to **Settings ‚Üí Environment Variables** and add:

```
OPENAI_API_KEY=your_api_key_here
```

### 4. Deploy

Click **Deploy** and wait for the process to complete.

Once deployed, your app will be available at:

```
https://your-project-name.vercel.app
```

---
